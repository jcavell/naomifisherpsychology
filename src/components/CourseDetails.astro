---
import { makeUrl, getImagePath } from "../scripts/url";
import Contributers from "./Contributers.astro";
import CourseSummary from "./CourseSummary.astro";
import Tags from "./Tags.astro";

const { title, summary, descriptions, testimonials = [], price, checkoutURL, imageFileName, people, tags, related } =
  Astro.props;

const descriptionText = descriptions.reduce(
  (acc: string, curr: string) => acc + " " + curr
);

const testinominalText = testimonials.reduce((acc: string, curr: string) => acc + " " + curr, [] as string[]);
---

<div class="card card-courses">
  <h2>
    <a href=`/courses/${makeUrl(title)}`>{title}</a>
  </h2>

  <img loading="lazy" src={`/images/courses/${imageFileName}`} alt=`Image for ${title}` />

  <div class="card-details">
    <a href="#" class="card-type-course"> RECORDED COURSE </a>
    <span> 2 HOURS, {price} </span>
  </div>

  <p>
    {descriptionText}
    {testinominalText}
  </p>

  <div class="card-meta">
    <Contributers people={people} />
    <Tags tags={tags} />
  </div>

  <div class="card-buttons">
    <a href={checkoutURL}> Purchase </a>
  </div>
</div>

<div>Related</div>

{
  related.map((course) => (
    <CourseSummary
      price={course.data.price}
      imageFileName={course.data.imageFileName}
      checkoutURL={course.data.checkoutUrl}
      title={course.data.title}
      summary={course.data.description}
      people={course.data.people}
      tags={course.data.tags}
    />
  ))
}
