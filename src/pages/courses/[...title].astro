---
import { makeUrl } from "../../scripts/url";
import CardLayout from "../../layouts/CardLayout.astro";
import CourseDetails from "../../components/CourseDetails.astro";
import getCourses from "../../scripts/courses";
import {getRelated} from  "../../scripts/courses";

export async function getStaticPaths() {
  const courses = await getCourses();

  return courses.map((course) => (
  {
    params: { title: makeUrl(course.data.title)},
    props: {
      course: course,
      related: getRelated(courses, course) },
  }
));
}  

const { course, related } = Astro.props;
---

<CardLayout pageTitle={course.data.title}>
  <CourseDetails
    price={course.data.price}
    imageFileName={course.data.imageFileName}
    checkoutURL={course.data.checkoutUrl}
    title={course.data.title}
    summary={course.data.description}
    descriptions={course.data.checkout?.descriptions}
    testimonials={course.data.checkout?.testimonials}
    people={course.data.people}
    tags={course.data.tags}
    related={related}
  />
</CardLayout>
